- route:
    id: sms-svc
    from:
      id: from3ccf
      uri: platform-http
      parameters:
        path: /SmsService.svc?httpMethodRestrict=POST
      steps:
        - convertBodyTo:
            id: convertBodyTo5d32
            description: convertBodyTo
            type: java.lang.String
        - setHeader:
            id: setHeadera745
            description: SH-Content-Type
            name: Content-Type
            expression:
              constant:
                id: constant8bed
                expression: text/xml; charset=UTF-8
        - setProperty:
            id: setProperty97de
            description: SP-rawXml
            name: rawXml
            expression:
              simple:
                id: simpled4f4
                expression: ${body}
        - log:
            id: log9feb
            description: xmlInboundBodyLog
            message: body
            loggingLevel: INFO
            logName: xmlBody
        - setProperty:
            id: setProperty727d
            name: smsTo
            expression:
              xpath:
                id: xpath7386
                expression: //SmsRequest/To/text()
                resultType: java.lang.String
        - log:
            id: log-c518
            message: "SMS To: \"${exchangeProperty.smsTo}\""
            loggingLevel: INFO
        - setProperty:
            id: setPropertya304
            name: smsText
            expression:
              xpath:
                id: xpath8111
                expression: /SmsRequest/Text/text()
        - removeHeaders:
            id: removeHeaders1653
            pattern: "*"
        - setBody:
            id: setBodyb486
            description: smsRequestBody
            expression:
              simple:
                id: simpleca89
                expression: |-
                  {
                      "messages": [
                          {
                              "sender": "ServiceSMS",
                              "destinations": [
                                  {
                                      "to": "905327907111"
                                  }
                              ],
                              "content": {
                                  "text": "deneme"
                              }
                          }
                      ]
                  }
        - log:
            id: logd47a
            message: body
            loggingLevel: INFO
            logName: RequestBody
        - setHeader:
            id: setHeader7ff0
            description: SH-Authorization
            name: Authorization
            expression:
              simple:
                id: simple5c94
                expression: App {{infobip.apiKey}}
        - setHeader:
            id: setHeader1565
            description: SH-Content-Type
            name: Content-Type
            expression:
              constant:
                id: constantcf15
                expression: application/json
        - to:
            id: to93a8
            uri: https
            parameters:
              httpUri: https://{{infobip.baseUrl}}/sms/3/messages
              bridgeEndpoint: false
        - setHeader:
            id: setHeader8715
            description: SH-Content-Type
            name: Content-Type
            expression:
              constant:
                id: constantba0c
                expression: text/xml; charset=UTF-8
        - setBody:
            id: setBody4005
            expression:
              simple:
                id: simple3830
                expression: |-
                  <SmsResponse>
                                <Status>OK</Status>
                                <To>${header.smsTo}</To>
                              </SmsResponse>
