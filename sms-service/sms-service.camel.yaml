- route:
    id: sms-svc
    from:
      id: from3ccf
      uri: platform-http
      parameters:
        path: /SmsService.svc?httpMethodRestrict=POST
      steps:
        - setHeader:
            id: setHeadera745
            description: SH-Content-Type
            name: Content-Type
            expression:
              constant:
                id: constant8bed
                expression: text/xml; charset=UTF-8
        - setProperty:
            id: setProperty97de
            description: SP-rawXml
            name: rawXml
            expression:
              simple:
                id: simpled4f4
                expression: ${body}
        - setHeader:
            id: setHeader3475
            description: SH-smsTo
            name: smsTo
            expression:
              simple:
                id: simple84d0
                expression: ${xpath:/SmsRequest/To/text()}
        - setHeader:
            id: setHeader9c37
            description: SH-smsText
            name: smsText
            expression:
              simple:
                id: simple0a3a
                expression: ${xpath:/SmsRequest/Text/text()}
        - setBody:
            id: setBodyb486
            description: smsRequestBody
            expression:
              simple:
                id: simpleca89
                expression: |
                  {
                               "messages":[
                                 {
                                   "sender":"ServiceSMS",
                                   "destinations":[{"to":"${header.smsTo}"}],
                                   "content":{"text":"${header.smsText}"}
                                 }
                               ]
                             }
        - setHeader:
            id: setHeader7ff0
            description: SH-Authorization
            name: Authorization
            expression:
              simple:
                id: simple5c94
                expression: App {{infobip.apiKey}}
        - setHeader:
            id: setHeader1565
            description: SH-Content-Type
            name: Content-Type
            expression:
              constant:
                id: constantcf15
                expression: application/json
        - to:
            id: to82fc
            uri: http
            parameters:
              httpUri: https://{{infobip.baseUrl}}/sms/3/messages
        - setHeader:
            id: setHeader8715
            description: SH-Content-Type
            name: Content-Type
            expression:
              constant:
                id: constantba0c
                expression: text/xml; charset=UTF-8
        - setBody:
            id: setBody4005
            expression:
              simple:
                id: simple3830
                expression: |-
                  <SmsResponse>
                                <Status>OK</Status>
                                <To>${header.smsTo}</To>
                              </SmsResponse>
